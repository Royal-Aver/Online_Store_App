{% extends "base.html" %}
{% load static %}
{% load carts_tags %}

{% block content %}
<section class="profile">
    <div class="profile_container container">
        <div class="profile_inner">
            <!-- Профиль с данными пользователя -->
            <div class="profile__inner-top">
                <h3 class="profile__title">Профиль пользователя</h3>
                <form action="{% url "user:profile" %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-12 mb-3 text-center">
                        {% if user.avatar %}
                        <img src="{{ user.avatar.url }}"
                             alt="Аватар пользователя" class="img-fluid rounded-circle"
                             style="max-width: 150px;">
                        {% else %}
                        <img src="{% static " images/baseavatar.jpg" %}"
                        alt="Аватар пользователя" class="img-fluid rounded-circle"
                        style="max-width: 150px;">
                        {% endif %}
                        <input type="file" class="form-control mt-3" id="id_avatar"
                               name="avatar"
                               accept="image/*">
                        {% if form.avatar.errors %}
                        <div class="alert alert-danger alert-dismissible fade show">
                            {{ form.avatar.errors }}
                        </div>
                        {% endif %}
                    </div>
                    <div class="col-md-12 mb-3">
                        <label for="id_first_name" class="form-label">Имя*</label>
                        <input type="text" class="form-control" id="id_first_name"
                               name="first_name"
                               placeholder="Введите ваше имя"
                               value="{{ form.first_name.value }}"
                               required>
                        {% if form.first_name.errors %}
                        <div class="alert alert-danger alert-dismissible fade show">
                            {{ form.first_name.errors }}
                        </div>
                        {% endif %}
                    </div>
                    <div class="col-md-12 mb-3">
                        <label for="id_last_name" class="form-label">Фамилия*</label>
                        <input type="text" class="form-control" id="id_last_name"
                               name="last_name"
                               placeholder="Введите вашу фамилию"
                               value="{{ form.last_name.value }}"
                               required>
                        {% if form.last_name.errors %}
                        <div class="alert alert-danger alert-dismissible fade show">
                            {{ form.last_name.errors }}
                        </div>
                        {% endif %}
                    </div>
                    <div class="col-md-12 mb-3">
                        <label for="username" class="form-label">Имя пользователя*</label>
                        <input type="text" class="form-control" id="username"
                               name="username"
                               placeholder="Введите ваше имя пользователя"
                               value="{{ form.username.value }}"
                               required>
                        {% if form.username.errors %}
                        <div class="alert alert-danger alert-dismissible fade show">
                            {{ form.username.errors }}
                        </div>
                        {% endif %}
                    </div>
                    <div class="col-md-12 mb-3">
                        <label for="email" class="form-label">Email*</label>
                        <input type="email" class="form-control" id="email"
                               name="email"
                               placeholder="Введите ваш email *youremail@example.com"
                               value="{{ form.email.value }}"
                               required>
                        {% if form.email.errors %}
                        <div class="alert alert-danger alert-dismissible fade show">
                            {{ form.email.errors }}
                        </div>
                        {% endif %}
                    </div>
                </div>
                <button type="submit" class="btn btn-dark">Сохранить</button>
                </form>
            </div>

            <!-- Корзина -->
            {% tag_user_carts request as carts %}
            <div class="col-md-7">
                <div class=" bg-white p-4 mb-4 mx-2 rounded custom-shadow">
                    <h3 class="text-center mb-4">Корзина</h3>
                    <div class="container" id="cart-items-container">
                        <!-- Разметка корзины -->
                        {% include "carts/includes/included_cart.html" %}
                        <!-- Закончилась разметка корзины -->
                    </div>
                    {% if carts %}
                    <a class="btn btn-dark" href="{% url 'orders:create_orders' %}">
                        Оформить заказ
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
